dist: trusty

sudo: required

language: csharp

mono: latest
dotnet: 1.0.1

script:
# SRC : Restore and Build
- dotnet restore src/SimMetrics.Net

- dotnet build src/SimMetrics.Net --configuration Release --framework netstandard1.0

- export FrameworkPathOverride=/usr/lib/mono/2.0-api
- dotnet build src/SimMetrics.Net --configuration Release --framework net20
- dotnet build src/SimMetrics.Net --configuration Release --framework net35

- export FrameworkPathOverride=/usr/lib/mono/4.0-api
- dotnet build src/SimMetrics.Net --configuration Release --framework net40

- export FrameworkPathOverride=/usr/lib/mono/4.5
- dotnet build src/SimMetrics.Net --configuration Release --framework net45

# TEST : Restore and Build
- dotnet restore tests/SimMetrics.Net.Tests

- dotnet build tests/SimMetrics.Net.Tests --configuration Release --framework netcoreapp1.1

# TEST : Execute
- dotnet test tests/SimMetrics.Net.Tests/SimMetrics.Net.Tests.csproj --configuration Release --framework netcoreapp1.1

# OpenCover and coveralls
- nuget.exe install OpenCover -ExcludeVersion
- nuget.exe install coveralls.net -ExcludeVersion

- OpenCover\tools\OpenCover.Console.exe -register:user -target:"dotnet.exe" -searchdirs:".\tests\SimMetrics.Net.Tests\bin\%CONFIGURATION%\netcoreapp1.1" -oldstyle -targetargs:"test .\tests\SimMetrics.Net.Tests" -returntargetcode -filter:"+[SimMetrics.Net]*" -output:coverage.xml
- "SET PATH=C:\\Python34;C:\\Python34\\Scripts;%PATH%"
- pip install codecov
- codecov -f "coverage.xml"
- coveralls.net\tools\csmacnz.Coveralls.exe --opencover -i .\coverage.xml